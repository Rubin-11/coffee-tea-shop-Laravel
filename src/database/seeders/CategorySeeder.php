<?php

namespace Database\Seeders;

use App\Models\Category;
use Illuminate\Database\Console\Seeds\WithoutModelEvents;
use Illuminate\Database\Seeder;
use Illuminate\Support\Str;

/**
 * Seeder –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤
 * 
 * –°–æ–∑–¥–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π –º–∞–≥–∞–∑–∏–Ω–∞:
 * - 5 –≥–ª–∞–≤–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–ö–æ—Ñ–µ –≤ –∑–µ—Ä–Ω–∞—Ö, –ú–æ–ª–æ—Ç—ã–π –∫–æ—Ñ–µ, –ß–∞–π, –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã, –ü–æ–¥–∞—Ä–æ—á–Ω—ã–µ –Ω–∞–±–æ—Ä—ã)
 * - 7-8 –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π –∫–æ—Ñ–µ (—Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è –∏ –≤–∏–¥—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏)
 */
class CategorySeeder extends Seeder
{
    use WithoutModelEvents;

    /**
     * –ó–∞–ø—É—Å–∫ seeder'–∞ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
     * 
     * –°–æ–∑–¥–∞–µ—Ç –≥–ª–∞–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –∏—Ö –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.
     * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –¥–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö.
     */
    public function run(): void
    {
        $this->command->info('üìÅ –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π...');

        // –°–æ–∑–¥–∞–µ–º –≥–ª–∞–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        $mainCategories = $this->createMainCategories();
        
        // –°–æ–∑–¥–∞–µ–º –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∫–æ—Ñ–µ
        $this->createCoffeeSubcategories($mainCategories);

        $this->command->info('‚úÖ –°–æ–∑–¥–∞–Ω–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: ' . Category::count());
    }

    /**
     * –°–æ–∑–¥–∞–Ω–∏–µ –≥–ª–∞–≤–Ω—ã—Ö (—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö) –∫–∞—Ç–µ–≥–æ—Ä–∏–π
     * 
     * –°–æ–∑–¥–∞–µ—Ç 5 –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –º–∞–≥–∞–∑–∏–Ω–∞, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è
     * –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é –∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
     * 
     * @return array<string, Category> –ú–∞—Å—Å–∏–≤ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å –∫–ª—é—á–∞–º–∏-–∏–º–µ–Ω–∞–º–∏
     */
    private function createMainCategories(): array
    {
        $categories = [];

        // –ú–∞—Å—Å–∏–≤ —Å –¥–∞–Ω–Ω—ã–º–∏ –≥–ª–∞–≤–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        $mainCategoriesData = [
            [
                'name' => '–ö–æ—Ñ–µ –≤ –∑–µ—Ä–Ω–∞—Ö',
                'slug' => 'kofe-v-zernah',
                'description' => '–°–≤–µ–∂–µ–æ–±–∂–∞—Ä–µ–Ω–Ω—ã–π –∫–æ—Ñ–µ –≤ –∑–µ—Ä–Ω–∞—Ö –∏–∑ —Ä–∞–∑–Ω—ã—Ö —É–≥–æ–ª–∫–æ–≤ –º–∏—Ä–∞. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ñ–µ–º–∞—à–∏–Ω–µ –∏–ª–∏ —Ç—É—Ä–∫–µ.',
                'image' => 'categories/coffee-beans.jpg',
                'sort_order' => 1,
            ],
            [
                'name' => '–ú–æ–ª–æ—Ç—ã–π –∫–æ—Ñ–µ',
                'slug' => 'molotyi-kofe',
                'description' => '–ì–æ—Ç–æ–≤—ã–π –∫ –∑–∞–≤–∞—Ä–∏–≤–∞–Ω–∏—é –º–æ–ª–æ—Ç—ã–π –∫–æ—Ñ–µ —Ä–∞–∑–ª–∏—á–Ω–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –ø–æ–º–æ–ª–∞. –£–¥–æ–±–µ–Ω –¥–ª—è —Ç—É—Ä–∫–∏, —Ñ—Ä–µ–Ω—á-–ø—Ä–µ—Å—Å–∞ –∏ –∫–∞–ø–µ–ª—å–Ω—ã—Ö –∫–æ—Ñ–µ–≤–∞—Ä–æ–∫.',
                'image' => 'categories/ground-coffee.jpg',
                'sort_order' => 2,
            ],
            [
                'name' => '–ß–∞–π',
                'slug' => 'chay',
                'description' => '–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ª–∏—Å—Ç–æ–≤–æ–π —á–∞–π: —á–µ—Ä–Ω—ã–π, –∑–µ–ª–µ–Ω—ã–π, –±–µ–ª—ã–π –∏ —É–ª—É–Ω. –ü—Ä—è–º—ã–µ –ø–æ—Å—Ç–∞–≤–∫–∏ –∏–∑ —á–∞–π–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤.',
                'image' => 'categories/tea.jpg',
                'sort_order' => 3,
            ],
            [
                'name' => '–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã',
                'slug' => 'aksessuary',
                'description' => '–í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ—Ñ–µ –∏ —á–∞—è: —Ç—É—Ä–∫–∏, –∫–æ—Ñ–µ–≤–∞—Ä–∫–∏, —á–∞–π–Ω–∏–∫–∏, —á–∞—à–∫–∏ –∏ –¥—Ä—É–≥–∏–µ –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã.',
                'image' => 'categories/accessories.jpg',
                'sort_order' => 4,
            ],
            [
                'name' => '–ü–æ–¥–∞—Ä–æ—á–Ω—ã–µ –Ω–∞–±–æ—Ä—ã',
                'slug' => 'podarochnye-nabory',
                'description' => '–ì–æ—Ç–æ–≤—ã–µ –ø–æ–¥–∞—Ä–æ—á–Ω—ã–µ –Ω–∞–±–æ—Ä—ã –¥–ª—è —Ü–µ–Ω–∏—Ç–µ–ª–µ–π –∫–æ—Ñ–µ –∏ —á–∞—è. –ö—Ä–∞—Å–∏–≤–∞—è —É–ø–∞–∫–æ–≤–∫–∞ –∏ –æ—Ç–±–æ—Ä–Ω—ã–µ —Å–æ—Ä—Ç–∞.',
                'image' => 'categories/gift-sets.jpg',
                'sort_order' => 5,
            ],
        ];

        // –°–æ–∑–¥–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
        foreach ($mainCategoriesData as $categoryData) {
            $category = Category::create([
                'name' => $categoryData['name'],
                'slug' => $categoryData['slug'],
                'description' => $categoryData['description'],
                'image' => $categoryData['image'],
                'parent_id' => null, // –ì–ª–∞–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –∏–º–µ–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è
                'sort_order' => $categoryData['sort_order'],
                'is_active' => true,
            ]);

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –≤ –º–∞—Å—Å–∏–≤ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
            $categories[$categoryData['name']] = $category;

            $this->command->line("  ‚úì –°–æ–∑–¥–∞–Ω–∞ –≥–ª–∞–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è: {$categoryData['name']}");
        }

        return $categories;
    }

    /**
     * –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è –∫–æ—Ñ–µ
     * 
     * –°–æ–∑–¥–∞–µ—Ç –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –≥–ª–∞–≤–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–ö–æ—Ñ–µ –≤ –∑–µ—Ä–Ω–∞—Ö".
     * –í–∫–ª—é—á–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è –∏ –≤–∏–¥—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–µ—Ä–Ω–∞.
     * 
     * @param array<string, Category> $mainCategories –ú–∞—Å—Å–∏–≤ –≥–ª–∞–≤–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
     */
    private function createCoffeeSubcategories(array $mainCategories): void
    {
        // –ü–æ–ª—É—á–∞–µ–º ID –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–ö–æ—Ñ–µ –≤ –∑–µ—Ä–Ω–∞—Ö"
        $coffeeCategory = $mainCategories['–ö–æ—Ñ–µ –≤ –∑–µ—Ä–Ω–∞—Ö'];

        // –ú–∞—Å—Å–∏–≤ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π –∫–æ—Ñ–µ
        $subcategoriesData = [
            [
                'name' => '–ö–æ–ª—É–º–±–∏—è',
                'slug' => 'kolumbiya',
                'description' => '–ö–æ–ª—É–º–±–∏–π—Å–∫–∞—è –∞—Ä–∞–±–∏–∫–∞ –∏–∑–≤–µ—Å—Ç–Ω–∞ —Å–≤–æ–∏–º –º—è–≥–∫–∏–º –≤–∫—É—Å–æ–º —Å –Ω–æ—Ç–∫–∞–º–∏ –∫–∞—Ä–∞–º–µ–ª–∏ –∏ –æ—Ä–µ—Ö–æ–≤. –°—Ä–µ–¥–Ω—è—è –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç—å.',
                'sort_order' => 1,
            ],
            [
                'name' => '–≠—Ñ–∏–æ–ø–∏—è',
                'slug' => 'efiopiya',
                'description' => '–≠—Ñ–∏–æ–ø—Å–∫–∏–π –∫–æ—Ñ–µ —Å —è—Ä–∫–∏–º–∏ —Ñ—Ä—É–∫—Ç–æ–≤—ã–º–∏ –∏ —Ü–≤–µ—Ç–æ—á–Ω—ã–º–∏ –Ω–æ—Ç–∞–º–∏. –†–æ–¥–∏–Ω–∞ –∫–æ—Ñ–µ –∞—Ä–∞–±–∏–∫–∞.',
                'sort_order' => 2,
            ],
            [
                'name' => '–ö–µ–Ω–∏—è',
                'slug' => 'keniya',
                'description' => '–ö–µ–Ω–∏–π—Å–∫–∏–π –∫–æ—Ñ–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –≤—ã—Å–æ–∫–æ–π –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç—å—é –∏ —è–≥–æ–¥–Ω—ã–º–∏ –Ω–æ—Ç–∞–º–∏. –ü–ª–æ—Ç–Ω–æ–µ —Ç–µ–ª–æ –∏ –≤–∏–Ω–Ω—ã–π –ø—Ä–∏–≤–∫—É—Å.',
                'sort_order' => 3,
            ],
            [
                'name' => '–ë—Ä–∞–∑–∏–ª–∏—è',
                'slug' => 'braziliya',
                'description' => '–ë—Ä–∞–∑–∏–ª—å—Å–∫–∏–π –∫–æ—Ñ–µ —Å –Ω–∏–∑–∫–æ–π –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç—å—é, –æ—Ä–µ—Ö–æ–≤—ã–º –≤–∫—É—Å–æ–º –∏ —à–æ–∫–æ–ª–∞–¥–Ω—ã–º–∏ –Ω–æ—Ç–∞–º–∏. –ò–¥–µ–∞–ª–µ–Ω –¥–ª—è —ç—Å–ø—Ä–µ—Å—Å–æ.',
                'sort_order' => 4,
            ],
            [
                'name' => '–ì–≤–∞—Ç–µ–º–∞–ª–∞',
                'slug' => 'gvatemala',
                'description' => '–ì–≤–∞—Ç–µ–º–∞–ª—å—Å–∫–∏–π –∫–æ—Ñ–µ —Å –Ω–∞—Å—ã—â–µ–Ω–Ω—ã–º –≤–∫—É—Å–æ–º, –Ω–æ—Ç–∞–º–∏ –∫–∞–∫–∞–æ –∏ –ø—Ä—è–Ω–æ—Å—Ç–µ–π. –°—Ä–µ–¥–Ω–µ–µ —Ç–µ–ª–æ.',
                'sort_order' => 5,
            ],
            [
                'name' => '–ö–æ—Å—Ç–∞-–†–∏–∫–∞',
                'slug' => 'kosta-rika',
                'description' => '–ö–æ—Å—Ç–∞—Ä–∏–∫–∞–Ω—Å–∫–∞—è –∞—Ä–∞–±–∏–∫–∞ —Å —á–∏—Å—Ç—ã–º –≤–∫—É—Å–æ–º, —Ü–∏—Ç—Ä—É—Å–æ–≤—ã–º–∏ –Ω–æ—Ç–∞–º–∏ –∏ —è—Ä–∫–æ–π –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç—å—é.',
                'sort_order' => 6,
            ],
            [
                'name' => '–≠—Å–ø—Ä–µ—Å—Å–æ-—Å–º–µ—Å–∏',
                'slug' => 'espresso-smesi',
                'description' => '–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–º–µ—Å–∏ –∑–µ—Ä–µ–Ω –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞–Ω –¥–ª—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ —ç—Å–ø—Ä–µ—Å—Å–æ. –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–∫—É—Å.',
                'sort_order' => 7,
            ],
            [
                'name' => '–ò–Ω–¥–æ–Ω–µ–∑–∏—è',
                'slug' => 'indoneziya',
                'description' => '–ò–Ω–¥–æ–Ω–µ–∑–∏–π—Å–∫–∏–π –∫–æ—Ñ–µ (–°—É–º–∞—Ç—Ä–∞, –Ø–≤–∞) —Å –∑–µ–º–ª–∏—Å—Ç—ã–º–∏ –Ω–æ—Ç–∞–º–∏, –Ω–∏–∑–∫–æ–π –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç—å—é –∏ –ø–ª–æ—Ç–Ω—ã–º —Ç–µ–ª–æ–º.',
                'sort_order' => 8,
            ],
        ];

        // –°–æ–∑–¥–∞–µ–º –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
        foreach ($subcategoriesData as $subcategoryData) {
            Category::create([
                'name' => $subcategoryData['name'],
                'slug' => $subcategoryData['slug'],
                'description' => $subcategoryData['description'],
                'image' => null, // –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–æ–≥—É—Ç –Ω–µ –∏–º–µ—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                'parent_id' => $coffeeCategory->id, // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–ö–æ—Ñ–µ –≤ –∑–µ—Ä–Ω–∞—Ö"
                'sort_order' => $subcategoryData['sort_order'],
                'is_active' => true,
            ]);

            $this->command->line("  ‚úì –°–æ–∑–¥–∞–Ω–∞ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è: {$subcategoryData['name']} (—Ä–æ–¥–∏—Ç–µ–ª—å: {$coffeeCategory->name})");
        }
    }
}
